<!doctype html><html><head><meta charset=utf-8><title>Introduction blog post</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=https://gofeatureflag.org/fa/css/all.min.css><script src=https://code.iconify.design/2/2.2.1/iconify.min.js></script>
<link href=https://gofeatureflag.org/scss/critical.min.css rel=stylesheet><link rel="shortcut icon" href=https://gofeatureflag.org/images/favicon.png type=image/x-icon><link rel=icon href=https://gofeatureflag.org/images/favicon.png type=image/x-icon><script async src="https://www.googletagmanager.com/gtag/js?id=G-YMBZZ2GYSK"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YMBZZ2GYSK")</script><script src=https://cdn.jsdelivr.net/npm/typed.js@2.0.12></script></head><body><nav class="main-nav navbar navbar-expand-lg"><div class=container-fluid><a class=navbar-brand href=https://gofeatureflag.org/><img class=logo-main src=https://gofeatureflag.org/images/logo.png alt=logo-white></a> <b>GO Feature Flag</b>
<button class="navbar-toggler collapsed" type=button data-toggle=collapse data-target=#mainNav>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button><div class="collapse navbar-collapse nav-list" id=mainNav><ul class="navbar-nav ml-auto"><li class=nav-item><a href=https://gofeatureflag.org/#hero class=nav-link>Home</a></li><li class=nav-item><a href=https://gofeatureflag.org/#feature class=nav-link>About</a></li><li class=nav-item><a href=https://gofeatureflag.org/#benefits class=nav-link>Why</a></li><li class=nav-item><a href=https://docs.gofeatureflag.org class=nav-link target=_blank>Documentation&nbsp;<i class="fas fa-external-link-alt"></i></a></li><li class=nav-item><a href=https://editor.gofeatureflag.org class=nav-link target=_blank>Editor&nbsp;<i class="fas fa-external-link-alt"></i></a></li></ul><div class="account-list list-inline"><li class=list-inline-item><a href=https://gofeatureflag.org/contact class="btn btn-sm btn-violate">Get in touch</a></li></div></div></div></nav><div id=content><section class="page-header blog-single-header"><div class=container><div class=row><div class=col-lg-12><h2>Introduction blog post</h2><div class=post-meta><ul><li><img src=https://gofeatureflag.org/images/blog/author/thomas-poignant.png alt=author-thumb></li><li><h5>Thomas Poignant</h5></li><li>January 11, 2021</li></ul></div></div></div></div></section><section class=blog-single><div class=container><div class=row><div class="col-lg-10 mx-auto"><article class=blog-single-post><h1 id=introduction-blog-post>Introduction blog post</h1><p>I absolutely don’t think human/manual QA gates should be involved in between the writing of code and its being live. To avoid breaking things every time and to have an early cutoff system, you should use feature flags.</p><p>There are a lot of systems available on the market to manage your flags, like <a href=https://launchdarkly.com/>LaunchDarkly</a> or <a href=https://unleash.org/>UNLEASH</a>, that have Golang support — but this option is expensive, and you have to host a server somewhere to manage your flags.</p><p>From this starting point, I came up with the idea to create a simple library with only one file in the back end. This file can be stored in different places (AWS S3, GitHub, an HTTP endpoint somewhere, etc.). This is the only thing you have to host — all the decision logic stands inside the Go module.</p><hr><h2 id=why-a-new-solution>Why a new solution?</h2><p>There are some solutions available for Go to manage feature flags. I can classify them into two categories:</p><ul><li>You need to run a specific service: <a href=https://github.com/markphelps/flipt>markphelps/flipt</a>, <a href=https://github.com/checkr/flagr>checkr/flagr</a>, <a href=https://github.com/Unleash/unleash>Unleash/unleash</a>, <a href=https://github.com/vsco/dcdr>vsco/dcdr</a>, etc.</li><li>You need to have a database: <a href=https://github.com/xchapter7x/toggle>xchapter7x/toggle</a>, <a href=https://github.com/AntoineAugusti/feature-flags>AntoineAugusti/feature-flags</a>, etc.</li></ul><p>All of these solutions are great and have a lot of features, but I was a bit worried about having a full setup with things to install before doing feature flags on a basic service.</p><p>I don’t want to host/maintain/monitor a full feature-flag system if my needs are really small.</p><p>So I decided to make go-feature-flag, a simple and easy-to-implement feature-flag system, with no back end at all except a shared configuration file you can store anywhere (S3, GitHub, HTTP endpoint, etc.).</p><p>The goal is to experience the usage of feature flags without a complex solution, and if you end up liking it and need a more advanced pattern, you can go to any open-source solution or SaaS solution — like LaunchDarkly, for example.</p><hr><h2 id=how-does-it-work>How Does It Work?</h2><p>How this Go module works is easy. It just reads the shared file every x seconds and gives you a way to get the value of your flag in the type you expect.</p><p><img src=/images/blog/20211011/sdk-explanation.jpg alt></p><p>As you can see, what go-feature-flag is providing is a way for you to keep in sync with the feature-flag config file. It also allows you to evaluate the flag for your users.</p><p>A rule system based on <a href=https://github.com/nikunjy/rules>nikunjy/rules</a> allows you to specify complex rules to apply the flag only for a subset of your users.</p><p>The percentage allows you to select which percentage of users will get the true value, but I’m sure you wonder how the repartition is done. It’s really easy — we’re doing a hash of the key of the user with the flag name used as a salt (it guarantees that the repartition isn’t always to the same users).</p><p><img src=/images/blog/20211011/code.jpg alt></p><hr><h2 id=how-to-use-it>How to Use It</h2><p>The main goal of go-feature-flag is to be super simple so you don’t have much to do in order to use it.</p><ul><li>The first thing to do is host your config file somewhere (S3, GitHub, etc.)</li><li>During app initialization, init go-feature-flag with a configuration:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ffclient</span>.<span style=color:#a6e22e>Init</span>(<span style=color:#a6e22e>ffclient</span>.<span style=color:#a6e22e>Config</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>PollInterval</span>: <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Retriever</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>ffClient</span>.<span style=color:#a6e22e>HTTPRetriever</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>URL</span>:    <span style=color:#e6db74>&#34;https://raw.githubusercontent.com/thomaspoignant/go-feature-flag/main/testdata/test.yaml&#34;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>ffclient</span>.<span style=color:#a6e22e>Close</span>()
</span></span></code></pre></div><ul><li>Now that you’ve done an init on go-feature-flag, you can see the value of the flag for your users, with something like this:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>user</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ffuser</span>.<span style=color:#a6e22e>NewUser</span>(<span style=color:#e6db74>&#34;user-unique-key&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>hasFlag</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ffclient</span>.<span style=color:#a6e22e>BoolVariation</span>(<span style=color:#e6db74>&#34;test-flag&#34;</span>, <span style=color:#a6e22e>user</span>, <span style=color:#66d9ef>false</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>hasFlag</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// flag &#34;test-flag&#34; is true for the user
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// flag &#34;test-flag&#34; is false for the user
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p><strong>Note</strong>: Your variation will return the default value (the last parameter) if you have an error (flag not present, wrong type, etc.).</p><ul><li>It’s a basic example, but you can put as many properties as you want for your User to make complex queries on your flag</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>user</span> = <span style=color:#a6e22e>ffuser</span>.<span style=color:#a6e22e>NewUserBuilder</span>(<span style=color:#e6db74>&#34;user-unique-key&#34;</span>).
</span></span><span style=display:flex><span> <span style=color:#a6e22e>AddCustom</span>(<span style=color:#e6db74>&#34;firstname&#34;</span>, <span style=color:#e6db74>&#34;John&#34;</span>).
</span></span><span style=display:flex><span> <span style=color:#a6e22e>AddCustom</span>(<span style=color:#e6db74>&#34;lastname&#34;</span>, <span style=color:#e6db74>&#34;Doe&#34;</span>).
</span></span><span style=display:flex><span> <span style=color:#a6e22e>AddCustom</span>(<span style=color:#e6db74>&#34;email&#34;</span>, <span style=color:#e6db74>&#34;john.doe@example.com&#34;</span>).
</span></span><span style=display:flex><span> <span style=color:#a6e22e>Build</span>()
</span></span></code></pre></div><p>This allows you to have a rule like <code>email eq "john.doe@example.com"</code> to select a specific user with your flag.</p><hr><h2 id=whats-next>What’s Next?</h2><p>As you can see go-feature-flag is simple, and the goal is to keep it as simple as possible. But this doesn’t mean it’s finished.</p><p>For now, I see an evolutionary path for go-feature-flag: First, it should be able to store the flag config file anywhere, so we have to support more retrievers. The second thing is to get more feedback. For now, we’re logging some stuff, but maybe some users would like to have a webhook or Slack notification.</p><p>go-feature-flag is also open to contribution, so if you want to contribute any ideas or help, I’d really love to hear from you concerning what you think about this library and what you want in it.</p><p>So feel free to write <a href=https://github.com/thomaspoignant/go-feature-flag/discussions>a discussion</a> on GitHub, open an <a href=https://github.com/thomaspoignant/go-feature-flag/issues>issue</a>, or send me an <a href=mailto:contact@gofeatureflag.org>email</a>.</p></article></div></div></div></section></div><footer class=footer><div class=container><div class=row><div class=col-lg-12><div class=footer-subscribe-title><h2>Get the latest app updates</h2></div></div><div class="col-lg-8 mx-auto"><form action="https://gofeatureflag.us14.list-manage.com/subscribe/post?u=86acc1a78e371bf66a9683672&id=f42abfec51&SIGNUP=https%3a%2f%2fgofeatureflag.org%2fblog%2f20210111-introduction-blog-post%2f" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class="validate footer-subscribe-form" target=_blank novalidate><div class=from-group><div class=input-group><input type=email name=EMAIL class="required email form-control" id=mce-EMAIL><div class=subscribe><button class="btn btn-subscribe" type=submit>
<span class=btn-area>Subscribe</span><svg class="icon-left" xmlns="http://www.w3.org/2000/svg" width="16.317" height="15.323" viewBox="0 0 16.317 15.323"><g data-name="Group 1167"><g data-name="Group 1166"><path data-name="Path 1349" d="M.004 5.359a.7.7.0 00.587.693l6.091 1.609L.591 9.27a.7.7.0 00-.587.693v4.656a.7.7.0 00.206.5.726.726.0 00.119.1.7.7.0 00.675.044l14.911-6.958a.7.7.0 000-1.274L1.004.066a.7.7.0 00-1 .637zm13.952 2.3" fill="#fff"/></g></g></svg><svg class="icon-center" xmlns="http://www.w3.org/2000/svg" width="16.317" height="15.323" viewBox="0 0 16.317 15.323"><g data-name="Group 1167"><g data-name="Group 1166"><path data-name="Path 1349" d="M.004 5.359a.7.7.0 00.587.693l6.091 1.609L.591 9.27a.7.7.0 00-.587.693v4.656a.7.7.0 00.206.5.726.726.0 00.119.1.7.7.0 00.675.044l14.911-6.958a.7.7.0 000-1.274L1.004.066a.7.7.0 00-1 .637zm13.952 2.3" fill="#fff"/></g></g></svg></button></div><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_86acc1a78e371bf66a9683672_f42abfec51 tabindex=-1></div></div><div id=mce-responses class=mt-2><div class="response alert alert-danger" id=mce-error-response style=display:none></div><div class="response alert alert-success" id=mce-success-response style=display:none></div></div></div></form></div><script type=text/javascript src=//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js></script><script type=text/javascript>(function(){window.fnames=new Array,window.ftypes=new Array,fnames[0]="EMAIL",ftypes[0]="email",fnames[1]="SIGNUP",ftypes[1]="text"})(jQuery);var $mcj=jQuery.noConflict(!0)</script></div><div class=row><div class="col-lg-4 col-md-4"><div class=footer-description><img src=https://gofeatureflag.org/images/logo.png width=250 alt=logo><p>All right reserved</br>© GO-feature-flag 2022</p><ul class=footer-description-social><li><a href=https://twitter.com/go-feature-flag><i class=ti-twitter-alt></i></a></li><li><a href=https://github.com/thomaspoignant><i class=ti-github></i></a></li></ul></div></div><div class="col-lg-4 col-md-4"><div class=footer-widget><h4>Sitemap</h4><div class=footer-widget-list><ul><li><a href=https://gofeatureflag.org/>Home</a></li><li><a href=https://gofeatureflag.org/blog>Latest Article</a></li><li><a href=https://gofeatureflag.org/contact>Contact</a></li></ul></div></div></div><div class="col-lg-4 col-md-4"><div class=footer-widget><h4>Address</h4><div class=footer-widget-list><ul><li><a href=mailto:contact@gofeatureflag.org><i class=ti-email></i>contact@gofeatureflag.org</a></li><li><p><i class=ti-pin></i>Paris, France</p></li></ul></div></div></div></div></div></footer><link href=https://gofeatureflag.org/scss/non-critical.min.css rel=stylesheet><script src=https://gofeatureflag.org/js/vendor.min.js></script>
<script src=https://gofeatureflag.org/js/form-handler.min.js></script>
<script src=https://gofeatureflag.org/js/script.min.js></script></body></html>