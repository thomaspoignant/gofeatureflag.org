<!doctype html><html><head><meta charset=utf-8><title>Automate Your Product Release Cycles Using Go-Feature-Flag</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=https://gofeatureflag.org/fa/css/all.min.css><script src=https://code.iconify.design/2/2.2.1/iconify.min.js></script>
<link href=https://gofeatureflag.org/scss/critical.min.css rel=stylesheet><link rel="shortcut icon" href=https://gofeatureflag.org/images/favicon.png type=image/x-icon><link rel=icon href=https://gofeatureflag.org/images/favicon.png type=image/x-icon><script async src="https://www.googletagmanager.com/gtag/js?id=G-YMBZZ2GYSK"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YMBZZ2GYSK")</script><script src=https://cdn.jsdelivr.net/npm/typed.js@2.0.12></script></head><body><nav class="main-nav navbar navbar-expand-lg"><div class=container-fluid><a class=navbar-brand href=https://gofeatureflag.org/><img class=logo-main src=https://gofeatureflag.org/images/logo.png alt=logo-white></a> <b>GO Feature Flag</b>
<button class="navbar-toggler collapsed" type=button data-toggle=collapse data-target=#mainNav>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button><div class="collapse navbar-collapse nav-list" id=mainNav><ul class="navbar-nav ml-auto"><li class=nav-item><a href=https://gofeatureflag.org/#hero class=nav-link>Home</a></li><li class=nav-item><a href=https://gofeatureflag.org/#feature class=nav-link>About</a></li><li class=nav-item><a href=https://gofeatureflag.org/#benefits class=nav-link>Why</a></li><li class=nav-item><a href=https://docs.gofeatureflag.org class=nav-link target=_blank>Documentation&nbsp;<i class="fas fa-external-link-alt"></i></a></li><li class=nav-item><a href=https://editor.gofeatureflag.org class=nav-link target=_blank>Editor&nbsp;<i class="fas fa-external-link-alt"></i></a></li></ul><div class="account-list list-inline"><li class=list-inline-item><a href=https://gofeatureflag.org/contact class="btn btn-sm btn-violate">Get in touch</a></li></div></div></div></nav><div id=content><section class="page-header blog-single-header"><div class=container><div class=row><div class=col-lg-12><h2>Automate Your Product Release Cycles Using Go-Feature-Flag</h2><div class=post-meta><ul><li><img src=https://gofeatureflag.org/images/blog/author/thomas-poignant.png alt=author-thumb></li><li><h5>Thomas Poignant</h5></li><li>January 11, 2021</li></ul></div></div></div></div></section><section class=blog-single><div class=container><div class=row><div class="col-lg-10 mx-auto"><article class=blog-single-post><p><img src=/images/blog/20210526/head.jpg alt></p><h1 id=automate-your-product-release-cycles-using-go-feature-flag>Automate Your Product Release Cycles Using Go-Feature-Flag</h1><p>When you build a new feature, orchestrating the actual launch schedule between the Product, Engineering, and Marketing teams can be challenging.</p><p>While it seems easy to launch something new, a poorly executed rollout can end up being your worst nightmare.</p><p>In this article, I will present to you how to use the Go module go-feature-flag to roll out your new features smoothly and help you be confident during the rollout phase. If you are not familiar with the concept of feature flags or feature toggles, I encourage you to read this <a href=https://www.martinfowler.com/articles/feature-toggles.html>article by Martin Fowler</a>.</p><p>go-feature-flag is a Go module to easily manage your flags. You can refer to this article I wrote a few months ago to understand how it works.</p><hr><h2 id=how-to-use-go-feature-flag>How To Use go-feature-flag</h2><p>The library is super simple to use:</p><ol><li>Install the module:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>go</span> <span style=color:#a6e22e>get</span> <span style=color:#a6e22e>github</span>.<span style=color:#a6e22e>com</span><span style=color:#f92672>/</span><span style=color:#a6e22e>thomaspoignant</span><span style=color:#f92672>/</span><span style=color:#66d9ef>go</span><span style=color:#f92672>-</span><span style=color:#a6e22e>feature</span><span style=color:#f92672>-</span><span style=color:#a6e22e>flag</span>
</span></span></code></pre></div><ol start=2><li>Init the client with the location of your configuration file for your flags:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ffclient</span>.<span style=color:#a6e22e>Init</span>(<span style=color:#a6e22e>ffclient</span>.<span style=color:#a6e22e>Config</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>PollInterval</span>: <span style=color:#ae81ff>60</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Retriever</span>: <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>ffclient</span>.<span style=color:#a6e22e>HTTPRetriever</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>URL</span>:    <span style=color:#e6db74>&#34;http://example.com/flag-config.yaml&#34;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>ffclient</span>.<span style=color:#a6e22e>Close</span>()
</span></span></code></pre></div><ol start=3><li>Put your new features conditionally based on the flag value:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>user</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ffuser</span>.<span style=color:#a6e22e>NewUser</span>(<span style=color:#e6db74>&#34;user-unique-key&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>hasFlag</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ffclient</span>.<span style=color:#a6e22e>BoolVariation</span>(<span style=color:#e6db74>&#34;test-flag&#34;</span>, <span style=color:#a6e22e>user</span>, <span style=color:#66d9ef>false</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>hasFlag</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// flag &#34;test-flag&#34; is true for the user
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// flag &#34;test-flag&#34; is false for the user
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>You can have way more configuration, but I’ll let you check the <a href=https://thomaspoignant.github.io/go-feature-flag/>documentation</a> for that.</p><hr><h2 id=progressive-rollout>Progressive Rollout</h2><p>When you release a new feature that can have a strong impact on your system, you probably don’t want to go all-in with this new feature for all your users.</p><p>For example, you are deploying something that can be CPU-consuming and you want to have time to check if your servers handle it correctly. This is typically a great use case for a progressive rollout.</p><p>It progressively increases how many users are impacted by your feature flag to avoid a big-bang rollout for all your users at once. During that time, it allows you to monitor your system and be confident that your infrastructure can handle this new load.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>progressive-flag</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>true</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>false</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>default</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rollout</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>progressive</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>percentage</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>initial</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>end</span>: <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>releaseRamp</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>start</span>: <span style=color:#e6db74>2021-03-20T00:00:00.10</span><span style=color:#ae81ff>-05</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>end</span>: <span style=color:#e6db74>2021-03-21T00:00:00.10</span><span style=color:#ae81ff>-05</span>:<span style=color:#ae81ff>00</span>
</span></span></code></pre></div><p>To do that in go-feature-flag, you will configure your flag like in the example above. You set up a progressive rollout with an initial percentage value and a release ramp. Over time, more and more users can be affected by the flag and will have the new feature.</p><p>Depending on how critical this feature is, you can have a long or a short release ramp. If something goes wrong, you can edit your flag to stop the rollout at any time.</p><hr><h2 id=scheduling-workflows>Scheduling Workflows</h2><p>Scheduling introduces the ability for users to change their flags for future points in time. While this sounds deceptively straightforward, it unlocks the potential for users to create complex release strategies by scheduling the incremental steps in advance.</p><p>For example, you may want to turn a feature on for internal testing tomorrow and then enable it for your “beta” user segment four days later.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>scheduled-flag</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>true</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>false</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>default</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>percentage</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rollout</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>scheduled</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>date</span>: <span style=color:#e6db74>2020-04-10T00:00:00.00</span><span style=color:#ae81ff>+02</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>rule</span>: <span style=color:#ae81ff>internal eq true</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>percentage: 100        - date</span>: <span style=color:#e6db74>2020-04-14T00:00:00.00</span><span style=color:#ae81ff>+02</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>rule: internal eq true and beta eq true        - date</span>: <span style=color:#e6db74>2020-04-18T00:00:00.00</span><span style=color:#ae81ff>+02</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>rule</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span></code></pre></div><p>In this example, you can see that we are updating the flag multiple times to perform actions in the future. Let’s detail what will happen in this configuration:</p><ol><li>Before <code>2020–04–10</code>, the flag is not served.</li><li>After the first update of the flag (<code>2020–04–10</code>), we have 100% of the internal users who received the flag as true.</li><li>Four days later, we add the users who have a <code>bet</code>a flag as <code>true</code>.</li><li>Finally, four days later, we open the feature to all users.</li></ol><p>As you can see, this is really powerful because your release management is now ready without doing any manual deployment/action, and this scheduling can be done by a non-technical user (aka your product manager).</p><hr><h2 id=experimentation-rollout>Experimentation Rollout</h2><p>Sometimes you also want to experiment, collect the data, and decide later if you want to roll out the feature to all your users.</p><p>To do that correctly, you can configure your flag with a start date and an end date for a subset of your users.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>experimentation-flag</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>percentage</span>: <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>true</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>false</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>default</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rule</span>: <span style=color:#ae81ff>userId sw &#34;9&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rollout</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>experimentation</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>start</span>: <span style=color:#e6db74>2021-03-20T00:00:00.10</span><span style=color:#ae81ff>-05</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>end</span>: <span style=color:#e6db74>2021-03-21T00:00:00.10</span><span style=color:#ae81ff>-05</span>:<span style=color:#ae81ff>00</span>
</span></span></code></pre></div><p>In this example, 50% of your users with a userId that starts with 9 will be impacted by the flag between the start and the end dates of the experimentation.</p><p>With the module, you can also collect the data of your variation (see the <a href=https://thomaspoignant.github.io/go-feature-flag/data_collection/>documentation</a> for more info) to join them with the data of what you are testing.</p><p>So you can see the results of your experimentation and decide whether you want to roll out this flag for real or not.</p><hr><h2 id=conclusion>Conclusion</h2><p>Using feature flags really is a great thing, but it becomes even better if you use some advanced rollout strategies.</p><p>If you start using them, you will love it because you decouple the deployment and the release and you can have fine-grained control over what your users can do.</p></article></div></div></div></section></div><footer class=footer><div class=container><div class=row><div class=col-lg-12><div class=footer-subscribe-title><h2>Get the latest app updates</h2></div></div><div class="col-lg-8 mx-auto"><form action="https://gofeatureflag.us14.list-manage.com/subscribe/post?u=86acc1a78e371bf66a9683672&id=f42abfec51&SIGNUP=https%3a%2f%2fgofeatureflag.org%2fblog%2f20210111-automate-your-product-release-cycles-using-go-feature-flag%2f" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class="validate footer-subscribe-form" target=_blank novalidate><div class=from-group><div class=input-group><input type=email name=EMAIL class="required email form-control" id=mce-EMAIL><div class=subscribe><button class="btn btn-subscribe" type=submit>
<span class=btn-area>Subscribe</span><svg class="icon-left" xmlns="http://www.w3.org/2000/svg" width="16.317" height="15.323" viewBox="0 0 16.317 15.323"><g data-name="Group 1167"><g data-name="Group 1166"><path data-name="Path 1349" d="M.004 5.359a.7.7.0 00.587.693l6.091 1.609L.591 9.27a.7.7.0 00-.587.693v4.656a.7.7.0 00.206.5.726.726.0 00.119.1.7.7.0 00.675.044l14.911-6.958a.7.7.0 000-1.274L1.004.066a.7.7.0 00-1 .637zm13.952 2.3" fill="#fff"/></g></g></svg><svg class="icon-center" xmlns="http://www.w3.org/2000/svg" width="16.317" height="15.323" viewBox="0 0 16.317 15.323"><g data-name="Group 1167"><g data-name="Group 1166"><path data-name="Path 1349" d="M.004 5.359a.7.7.0 00.587.693l6.091 1.609L.591 9.27a.7.7.0 00-.587.693v4.656a.7.7.0 00.206.5.726.726.0 00.119.1.7.7.0 00.675.044l14.911-6.958a.7.7.0 000-1.274L1.004.066a.7.7.0 00-1 .637zm13.952 2.3" fill="#fff"/></g></g></svg></button></div><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_86acc1a78e371bf66a9683672_f42abfec51 tabindex=-1></div></div><div id=mce-responses class=mt-2><div class="response alert alert-danger" id=mce-error-response style=display:none></div><div class="response alert alert-success" id=mce-success-response style=display:none></div></div></div></form></div><script type=text/javascript src=//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js></script><script type=text/javascript>(function(){window.fnames=new Array,window.ftypes=new Array,fnames[0]="EMAIL",ftypes[0]="email",fnames[1]="SIGNUP",ftypes[1]="text"})(jQuery);var $mcj=jQuery.noConflict(!0)</script></div><div class=row><div class="col-lg-4 col-md-4"><div class=footer-description><img src=https://gofeatureflag.org/images/logo.png width=250 alt=logo><p>All right reserved</br>© GO-feature-flag 2022</p><ul class=footer-description-social><li><a href=https://twitter.com/go-feature-flag><i class=ti-twitter-alt></i></a></li><li><a href=https://github.com/thomaspoignant><i class=ti-github></i></a></li></ul></div></div><div class="col-lg-4 col-md-4"><div class=footer-widget><h4>Sitemap</h4><div class=footer-widget-list><ul><li><a href=https://gofeatureflag.org/>Home</a></li><li><a href=https://gofeatureflag.org/blog>Latest Article</a></li><li><a href=https://gofeatureflag.org/contact>Contact</a></li></ul></div></div></div><div class="col-lg-4 col-md-4"><div class=footer-widget><h4>Address</h4><div class=footer-widget-list><ul><li><a href=mailto:contact@gofeatureflag.org><i class=ti-email></i>contact@gofeatureflag.org</a></li><li><p><i class=ti-pin></i>Paris, France</p></li></ul></div></div></div></div></div></footer><link href=https://gofeatureflag.org/scss/non-critical.min.css rel=stylesheet><script src=https://gofeatureflag.org/js/vendor.min.js></script>
<script src=https://gofeatureflag.org/js/form-handler.min.js></script>
<script src=https://gofeatureflag.org/js/script.min.js></script></body></html>